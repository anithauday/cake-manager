{"ast":null,"code":"import _defineProperty from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Redirect}from'react-router-dom';import{Container}from'semantic-ui-react';import AuthContext from'../context/AuthContext';import{orderApi}from'../misc/OrderApi';import AdminTab from'./AdminTab';import{handleLogError}from'../misc/Helpers';import{jsx as _jsx}from\"react/jsx-runtime\";var AdminPage=/*#__PURE__*/function(_Component){_inherits(AdminPage,_Component);var _super=_createSuper(AdminPage);function AdminPage(){var _this;_classCallCheck(this,AdminPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={users:[],orders:[],orderDescription:'',orderTextSearch:'',userUsernameSearch:'',isAdmin:true,isUsersLoading:false,isOrdersLoading:false};_this.handleInputChange=function(e,_ref){var name=_ref.name,value=_ref.value;_this.setState(_defineProperty({},name,value));};_this.handleGetUsers=function(){var Auth=_this.context;var user=Auth.getUser();_this.setState({isUsersLoading:true});orderApi.getUsers(user).then(function(response){_this.setState({users:response.data});}).catch(function(error){handleLogError(error);}).finally(function(){_this.setState({isUsersLoading:false});});};_this.handleDeleteUser=function(username){var Auth=_this.context;var user=Auth.getUser();orderApi.deleteUser(user,username).then(function(){_this.handleGetUsers();}).catch(function(error){handleLogError(error);});};_this.handleSearchUser=function(){var Auth=_this.context;var user=Auth.getUser();var username=_this.state.userUsernameSearch;orderApi.getUsers(user,username).then(function(response){var data=response.data;var users=data instanceof Array?data:[data];_this.setState({users:users});}).catch(function(error){handleLogError(error);_this.setState({users:[]});});};_this.handleGetOrders=function(){var Auth=_this.context;var user=Auth.getUser();_this.setState({isOrdersLoading:true});orderApi.getOrders(user).then(function(response){_this.setState({orders:response.data});}).catch(function(error){handleLogError(error);}).finally(function(){_this.setState({isOrdersLoading:false});});};_this.handleDeleteOrder=function(isbn){var Auth=_this.context;var user=Auth.getUser();orderApi.deleteOrder(user,isbn).then(function(){_this.handleGetOrders();}).catch(function(error){handleLogError(error);});};_this.handleCreateOrder=function(){var Auth=_this.context;var user=Auth.getUser();var orderDescription=_this.state.orderDescription;orderDescription=orderDescription.trim();if(!orderDescription){return;}var order={description:orderDescription};orderApi.createOrder(user,order).then(function(){_this.handleGetOrders();_this.setState({orderDescription:''});}).catch(function(error){handleLogError(error);});};_this.handleSearchOrder=function(){var Auth=_this.context;var user=Auth.getUser();var text=_this.state.orderTextSearch;orderApi.getOrders(user,text).then(function(response){var orders=response.data;_this.setState({orders:orders});}).catch(function(error){handleLogError(error);_this.setState({orders:[]});});};return _this;}_createClass(AdminPage,[{key:\"componentDidMount\",value:function componentDidMount(){var Auth=this.context;var user=Auth.getUser();var isAdmin=user.data.rol[0]==='ADMIN';this.setState({isAdmin:isAdmin});this.handleGetUsers();this.handleGetOrders();}},{key:\"render\",value:function render(){if(!this.state.isAdmin){return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}else{var _this$state=this.state,isUsersLoading=_this$state.isUsersLoading,users=_this$state.users,userUsernameSearch=_this$state.userUsernameSearch,isOrdersLoading=_this$state.isOrdersLoading,orders=_this$state.orders,orderDescription=_this$state.orderDescription,orderTextSearch=_this$state.orderTextSearch;return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(AdminTab,{isUsersLoading:isUsersLoading,users:users,userUsernameSearch:userUsernameSearch,handleDeleteUser:this.handleDeleteUser,handleSearchUser:this.handleSearchUser,isOrdersLoading:isOrdersLoading,orders:orders,orderDescription:orderDescription,orderTextSearch:orderTextSearch,handleCreateOrder:this.handleCreateOrder,handleDeleteOrder:this.handleDeleteOrder,handleSearchOrder:this.handleSearchOrder,handleInputChange:this.handleInputChange})});}}}]);return AdminPage;}(Component);AdminPage.contextType=AuthContext;export default AdminPage;","map":{"version":3,"sources":["/Users/baran/Desktop/cake-manager/cake-ui/src/components/admin/AdminPage.js"],"names":["React","Component","Redirect","Container","AuthContext","orderApi","AdminTab","handleLogError","AdminPage","state","users","orders","orderDescription","orderTextSearch","userUsernameSearch","isAdmin","isUsersLoading","isOrdersLoading","handleInputChange","e","name","value","setState","handleGetUsers","Auth","context","user","getUser","getUsers","then","response","data","catch","error","finally","handleDeleteUser","username","deleteUser","handleSearchUser","Array","handleGetOrders","getOrders","handleDeleteOrder","isbn","deleteOrder","handleCreateOrder","trim","order","description","createOrder","handleSearchOrder","text","rol","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Redirect } from 'react-router-dom'\nimport { Container } from 'semantic-ui-react'\nimport AuthContext from '../context/AuthContext'\nimport { orderApi } from '../misc/OrderApi'\nimport AdminTab from './AdminTab'\nimport { handleLogError } from '../misc/Helpers'\n\nclass AdminPage extends Component {\n  static contextType = AuthContext\n\n  state = {\n    users: [],\n    orders: [],\n    orderDescription: '',\n    orderTextSearch: '',\n    userUsernameSearch: '',\n    isAdmin: true,\n    isUsersLoading: false,\n    isOrdersLoading: false,\n  }\n\n  componentDidMount() {\n    const Auth = this.context\n    const user = Auth.getUser()\n    const isAdmin = user.data.rol[0] === 'ADMIN'\n    this.setState({ isAdmin })\n\n    this.handleGetUsers()\n    this.handleGetOrders()\n  }\n\n  handleInputChange = (e, {name, value}) => {\n    this.setState({ [name]: value })\n  }\n\n  handleGetUsers = () => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    this.setState({ isUsersLoading: true })\n    orderApi.getUsers(user)\n      .then(response => {\n        this.setState({ users: response.data })\n      })\n      .catch(error => {\n        handleLogError(error)\n      })\n      .finally(() => {\n        this.setState({ isUsersLoading: false })\n      })\n  }\n\n  handleDeleteUser = (username) => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    orderApi.deleteUser(user, username)\n      .then(() => {\n        this.handleGetUsers()\n      })\n      .catch(error => {\n        handleLogError(error)\n      })\n  }\n\n  handleSearchUser = () => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    const username = this.state.userUsernameSearch\n    orderApi.getUsers(user, username)\n      .then(response => {\n        const data = response.data\n        const users = data instanceof Array ? data : [data]\n        this.setState({ users })\n      })\n      .catch(error => {\n        handleLogError(error)\n        this.setState({ users: [] })\n      })\n  }\n\n  handleGetOrders = () => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    this.setState({ isOrdersLoading: true })\n    orderApi.getOrders(user)\n      .then(response => {\n        this.setState({ orders: response.data })\n      })\n      .catch(error => {\n        handleLogError(error)\n      })\n      .finally(() => {\n        this.setState({ isOrdersLoading: false })\n      })\n  }\n\n  handleDeleteOrder = (isbn) => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    orderApi.deleteOrder(user, isbn)\n      .then(() => {\n        this.handleGetOrders()\n      })\n      .catch(error => {\n        handleLogError(error)\n      })\n  }\n\n  handleCreateOrder = () => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    let { orderDescription } = this.state\n    orderDescription = orderDescription.trim()\n    if (!orderDescription) {\n      return\n    }\n\n    const order = { description: orderDescription }\n    orderApi.createOrder(user, order)\n      .then(() => {\n        this.handleGetOrders()\n        this.setState({ orderDescription: '' })\n      })\n      .catch(error => {\n        handleLogError(error)\n      })\n  }\n\n  handleSearchOrder = () => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    const text = this.state.orderTextSearch\n    orderApi.getOrders(user, text)\n      .then(response => {\n        const orders = response.data\n        this.setState({ orders })\n      })\n      .catch(error => {\n        handleLogError(error)\n        this.setState({ orders: [] })\n      })\n  }\n\n  render() {\n    if (!this.state.isAdmin) {\n      return <Redirect to='/' />\n    } else {\n      const { isUsersLoading, users, userUsernameSearch, isOrdersLoading, orders, orderDescription, orderTextSearch } = this.state\n      return (\n        <Container>\n          <AdminTab\n            isUsersLoading={isUsersLoading}\n            users={users}\n            userUsernameSearch={userUsernameSearch}\n            handleDeleteUser={this.handleDeleteUser}\n            handleSearchUser={this.handleSearchUser}\n            isOrdersLoading={isOrdersLoading}\n            orders={orders}\n            orderDescription={orderDescription}\n            orderTextSearch={orderTextSearch}\n            handleCreateOrder={this.handleCreateOrder}\n            handleDeleteOrder={this.handleDeleteOrder}\n            handleSearchOrder={this.handleSearchOrder}\n            handleInputChange={this.handleInputChange}\n          />\n        </Container>\n      )\n    }\n  }\n}\n\nexport default AdminPage"]},"metadata":{},"sourceType":"module"}