{"ast":null,"code":"import _classCallCheck from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component,useContext}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/React.createContext();var AuthProvider=/*#__PURE__*/function(_Component){_inherits(AuthProvider,_Component);var _super=_createSuper(AuthProvider);function AuthProvider(){var _this;_classCallCheck(this,AuthProvider);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={user:null};_this.getUser=function(){return JSON.parse(localStorage.getItem('user'));};_this.userIsAuthenticated=function(){var user=localStorage.getItem('user');if(!user){return false;}user=JSON.parse(user);// if user has token expired, logout user\nif(Date.now()>user.data.exp*1000){_this.userLogout();return false;}return true;};_this.userLogin=function(user){localStorage.setItem('user',JSON.stringify(user));_this.setState({user:user});};_this.userLogout=function(){localStorage.removeItem('user');_this.setState({user:null});};return _this;}_createClass(AuthProvider,[{key:\"componentDidMount\",value:function componentDidMount(){var user=localStorage.getItem('user');this.setState({user:user});}},{key:\"render\",value:function render(){var children=this.props.children;var user=this.state.user;var getUser=this.getUser,userIsAuthenticated=this.userIsAuthenticated,userLogin=this.userLogin,userLogout=this.userLogout;return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user:user,getUser:getUser,userIsAuthenticated:userIsAuthenticated,userLogin:userLogin,userLogout:userLogout},children:children});}}]);return AuthProvider;}(Component);export default AuthContext;export function useAuth(){return useContext(AuthContext);}export{AuthProvider};","map":{"version":3,"sources":["/Users/baran/Desktop/cake-manager/cake-ui/src/components/context/AuthContext.js"],"names":["React","Component","useContext","AuthContext","createContext","AuthProvider","state","user","getUser","JSON","parse","localStorage","getItem","userIsAuthenticated","Date","now","data","exp","userLogout","userLogin","setItem","stringify","setState","removeItem","children","props","useAuth"],"mappings":"gnBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,UAA3B,KAA6C,OAA7C,C,2CAEA,GAAMC,CAAAA,WAAW,cAAGH,KAAK,CAACI,aAAN,EAApB,C,GAEMC,CAAAA,Y,mVACJC,K,CAAQ,CACNC,IAAI,CAAE,IADA,C,OASRC,O,CAAU,UAAM,CACd,MAAOC,CAAAA,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAP,CACD,C,OAEDC,mB,CAAsB,UAAM,CAC1B,GAAIN,CAAAA,IAAI,CAAGI,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CACA,GAAI,CAACL,IAAL,CAAW,CACT,MAAO,MAAP,CACD,CACDA,IAAI,CAAGE,IAAI,CAACC,KAAL,CAAWH,IAAX,CAAP,CAEA;AACA,GAAIO,IAAI,CAACC,GAAL,GAAaR,IAAI,CAACS,IAAL,CAAUC,GAAV,CAAgB,IAAjC,CAAuC,CACrC,MAAKC,UAAL,GACA,MAAO,MAAP,CACD,CACD,MAAO,KAAP,CACD,C,OAEDC,S,CAAY,SAAAZ,IAAI,CAAI,CAClBI,YAAY,CAACS,OAAb,CAAqB,MAArB,CAA6BX,IAAI,CAACY,SAAL,CAAed,IAAf,CAA7B,EACA,MAAKe,QAAL,CAAc,CAAEf,IAAI,CAAJA,IAAF,CAAd,EACD,C,OAEDW,U,CAAa,UAAM,CACjBP,YAAY,CAACY,UAAb,CAAwB,MAAxB,EACA,MAAKD,QAAL,CAAc,CAAEf,IAAI,CAAE,IAAR,CAAd,EACD,C,qGAhCmB,CAClB,GAAMA,CAAAA,IAAI,CAAGI,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAb,CACA,KAAKU,QAAL,CAAc,CAAEf,IAAI,CAAJA,IAAF,CAAd,EACD,C,uCA+BQ,IACCiB,CAAAA,QADD,CACc,KAAKC,KADnB,CACCD,QADD,IAECjB,CAAAA,IAFD,CAEU,KAAKD,KAFf,CAECC,IAFD,IAGCC,CAAAA,OAHD,CAGyD,IAHzD,CAGCA,OAHD,CAGUK,mBAHV,CAGyD,IAHzD,CAGUA,mBAHV,CAG+BM,SAH/B,CAGyD,IAHzD,CAG+BA,SAH/B,CAG0CD,UAH1C,CAGyD,IAHzD,CAG0CA,UAH1C,CAKP,mBACE,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAE,CAAEX,IAAI,CAAJA,IAAF,CAAQC,OAAO,CAAPA,OAAR,CAAiBK,mBAAmB,CAAnBA,mBAAjB,CAAsCM,SAAS,CAATA,SAAtC,CAAiDD,UAAU,CAAVA,UAAjD,CAA7B,UACGM,QADH,EADF,CAKD,C,0BAjDwBvB,S,EAoD3B,cAAeE,CAAAA,WAAf,CAEA,MAAO,SAASuB,CAAAA,OAAT,EAAmB,CACxB,MAAOxB,CAAAA,UAAU,CAACC,WAAD,CAAjB,CACD,CAED,OAASE,YAAT","sourcesContent":["import React, { Component, useContext } from 'react'\n\nconst AuthContext = React.createContext()\n\nclass AuthProvider extends Component {\n  state = {\n    user: null\n  }\n\n  componentDidMount() {\n    const user = localStorage.getItem('user')\n    this.setState({ user })\n  }\n\n  getUser = () => {\n    return JSON.parse(localStorage.getItem('user'))\n  }\n\n  userIsAuthenticated = () => {\n    let user = localStorage.getItem('user')\n    if (!user) {\n      return false\n    }\n    user = JSON.parse(user)\n    \n    // if user has token expired, logout user\n    if (Date.now() > user.data.exp * 1000) {\n      this.userLogout()\n      return false\n    }\n    return true\n  }\n\n  userLogin = user => {\n    localStorage.setItem('user', JSON.stringify(user))\n    this.setState({ user })\n  }\n\n  userLogout = () => {\n    localStorage.removeItem('user')\n    this.setState({ user: null })\n  }\n\n  render() {\n    const { children } = this.props\n    const { user } = this.state\n    const { getUser, userIsAuthenticated, userLogin, userLogout } = this\n\n    return (\n      <AuthContext.Provider value={{ user, getUser, userIsAuthenticated, userLogin, userLogout, }}>\n        {children}\n      </AuthContext.Provider>\n    )\n  }\n}\n\nexport default AuthContext\n\nexport function useAuth() {\n  return useContext(AuthContext)\n}\n\nexport { AuthProvider }"]},"metadata":{},"sourceType":"module"}