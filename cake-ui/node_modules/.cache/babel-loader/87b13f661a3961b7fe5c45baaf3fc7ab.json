{"ast":null,"code":"import _defineProperty from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/baran/Desktop/cake-manager/cake-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Redirect}from'react-router-dom';import{Container}from'semantic-ui-react';import OrderTable from'./OrderTable';import AuthContext from'../context/AuthContext';import{orderApi}from'../misc/OrderApi';import{handleLogError}from'../misc/Helpers';import{jsx as _jsx}from\"react/jsx-runtime\";var UserPage=/*#__PURE__*/function(_Component){_inherits(UserPage,_Component);var _super=_createSuper(UserPage);function UserPage(){var _this;_classCallCheck(this,UserPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={userMe:null,isUser:true,isLoading:false,orderDescription:''};_this.handleInputChange=function(e,_ref){var name=_ref.name,value=_ref.value;_this.setState(_defineProperty({},name,value));};_this.handleGetUserMe=function(){var Auth=_this.context;var user=Auth.getUser();_this.setState({isLoading:true});orderApi.getUserMe(user).then(function(response){_this.setState({userMe:response.data});}).catch(function(error){handleLogError(error);}).finally(function(){_this.setState({isLoading:false});});};_this.handleCreateOrder=function(){var Auth=_this.context;var user=Auth.getUser();var orderDescription=_this.state.orderDescription;orderDescription=orderDescription.trim();if(!orderDescription){return;}var order={description:orderDescription};orderApi.createOrder(user,order).then(function(){_this.handleGetUserMe();_this.setState({orderDescription:''});}).catch(function(error){handleLogError(error);});};return _this;}_createClass(UserPage,[{key:\"componentDidMount\",value:function componentDidMount(){var Auth=this.context;var user=Auth.getUser();var isUser=user.data.rol[0]==='USER';this.setState({isUser:isUser});this.handleGetUserMe();}},{key:\"render\",value:function render(){if(!this.state.isUser){return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}else{var _this$state=this.state,userMe=_this$state.userMe,isLoading=_this$state.isLoading,orderDescription=_this$state.orderDescription;return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(OrderTable,{orders:userMe&&userMe.orders,isLoading:isLoading,orderDescription:orderDescription,handleCreateOrder:this.handleCreateOrder,handleInputChange:this.handleInputChange})});}}}]);return UserPage;}(Component);UserPage.contextType=AuthContext;export default UserPage;","map":{"version":3,"sources":["/Users/baran/Desktop/cake-manager/cake-ui/src/components/user/UserPage.js"],"names":["React","Component","Redirect","Container","OrderTable","AuthContext","orderApi","handleLogError","UserPage","state","userMe","isUser","isLoading","orderDescription","handleInputChange","e","name","value","setState","handleGetUserMe","Auth","context","user","getUser","getUserMe","then","response","data","catch","error","finally","handleCreateOrder","trim","order","description","createOrder","rol","orders","contextType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Redirect } from 'react-router-dom'\nimport { Container } from 'semantic-ui-react'\nimport OrderTable from './OrderTable'\nimport AuthContext from '../context/AuthContext'\nimport { orderApi } from '../misc/OrderApi'\nimport { handleLogError } from '../misc/Helpers'\n\nclass UserPage extends Component {\n  static contextType = AuthContext\n\n  state = {\n    userMe: null,\n    isUser: true,\n    isLoading: false,\n    orderDescription: ''\n  }\n\n  componentDidMount() {\n    const Auth = this.context\n    const user = Auth.getUser()\n    const isUser = user.data.rol[0] === 'USER'\n    this.setState({ isUser })\n\n    this.handleGetUserMe()\n  }\n\n  handleInputChange = (e, {name, value}) => {\n    this.setState({ [name]: value })\n  }\n\n  handleGetUserMe = () => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    this.setState({ isLoading: true })\n    orderApi.getUserMe(user)\n      .then(response => {\n        this.setState({ userMe: response.data })\n      })\n      .catch(error => {\n        handleLogError(error)\n      })\n      .finally(() => {\n        this.setState({ isLoading: false })\n      })\n  }\n  \n  handleCreateOrder = () => {\n    const Auth = this.context\n    const user = Auth.getUser()\n\n    let { orderDescription } = this.state\n    orderDescription = orderDescription.trim()\n    if (!orderDescription) {\n      return\n    }\n\n    const order = { description: orderDescription }\n    orderApi.createOrder(user, order)\n      .then(() => {\n        this.handleGetUserMe()\n        this.setState({ orderDescription: '' })\n      })\n      .catch(error => {\n        handleLogError(error)\n      })\n  }\n\n  render() {\n    if (!this.state.isUser) {\n      return <Redirect to='/' />\n    } else {\n      const { userMe, isLoading, orderDescription } = this.state\n      return (\n        <Container>\n          <OrderTable\n            orders={userMe && userMe.orders}\n            isLoading={isLoading}\n            orderDescription={orderDescription}\n            handleCreateOrder={this.handleCreateOrder}\n            handleInputChange={this.handleInputChange}\n          />\n        </Container>\n      )\n    }\n  }\n}\n\nexport default UserPage"]},"metadata":{},"sourceType":"module"}