{"ast":null,"code":"import axios from'axios';import{config}from'../../Constants';import{parseJwt}from'./Helpers';export var orderApi={authenticate:authenticate,signup:signup,numberOfUsers:numberOfUsers,numberOfOrders:numberOfOrders,getUsers:getUsers,deleteUser:deleteUser,getOrders:getOrders,deleteOrder:deleteOrder,createOrder:createOrder,getUserMe:getUserMe};function authenticate(username,password){return instance.post('/auth/login',{username:username,password:password},{headers:{'Content-type':'application/json',\"Access-Control-Allow-Origin\":\"*\"}});}function signup(user){return instance.post('/auth/signup',user,{headers:{'Content-type':'application/json'}});}function numberOfUsers(){return instance.get('/public/numberOfUsers');}function numberOfOrders(){return instance.get('/public/numberOfOrders');}function getUsers(user,username){var url=username?\"/api/users/\".concat(username):'/api/users';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteUser(user,username){return instance.delete(\"/api/users/\".concat(username),{headers:{'Authorization':bearerAuth(user)}});}function getOrders(user,text){var url=text?\"/api/orders?text=\".concat(text):'/api/orders';return instance.get(url,{headers:{'Authorization':bearerAuth(user)}});}function deleteOrder(user,orderId){return instance.delete(\"/api/orders/\".concat(orderId),{headers:{'Authorization':bearerAuth(user)}});}function createOrder(user,order){return instance.post('/api/orders',order,{headers:{'Content-type':'application/json','Authorization':bearerAuth(user)}});}function getUserMe(user){return instance.get('/api/users/me',{headers:{'Authorization':bearerAuth(user)}});}// -- Axios\nvar instance=axios.create({baseURL:config.url.API_BASE_URL});instance.interceptors.request.use(function(config){// If token is expired, redirect user to login\nif(config.headers.Authorization){var token=config.headers.Authorization.split(' ')[1];var data=parseJwt(token);if(Date.now()>data.exp*1000){window.location.href=\"/login\";}}return config;},function(error){return Promise.reject(error);});// -- Helper functions\nfunction bearerAuth(user){return\"Bearer \".concat(user.accessToken);}","map":{"version":3,"sources":["/Users/baran/Desktop/cake-manager/cake-ui/src/components/misc/OrderApi.js"],"names":["axios","config","parseJwt","orderApi","authenticate","signup","numberOfUsers","numberOfOrders","getUsers","deleteUser","getOrders","deleteOrder","createOrder","getUserMe","username","password","instance","post","headers","user","get","url","bearerAuth","delete","text","orderId","order","create","baseURL","API_BASE_URL","interceptors","request","use","Authorization","token","split","data","Date","now","exp","window","location","href","error","Promise","reject","accessToken"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport { config } from '../../Constants'\nimport { parseJwt } from './Helpers'\n\nexport const orderApi = {\n  authenticate,\n  signup,\n  numberOfUsers,\n  numberOfOrders,\n  getUsers,\n  deleteUser,\n  getOrders,\n  deleteOrder,\n  createOrder,\n  getUserMe\n}\n\nfunction authenticate(username, password) {\n  return instance.post('/auth/login', { username, password }, {\n    headers: { 'Content-type': 'application/json' , \"Access-Control-Allow-Origin\": \"*\"}\n  })\n}\n\nfunction signup(user) {\n  return instance.post('/auth/signup', user, {\n    headers: { 'Content-type': 'application/json' }\n  })\n}\n\nfunction numberOfUsers() {\n  return instance.get('/public/numberOfUsers')\n}\n\nfunction numberOfOrders() {\n  return instance.get('/public/numberOfOrders')\n}\n\nfunction getUsers(user, username) {\n  const url = username ? `/api/users/${username}` : '/api/users'\n  return instance.get(url, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction deleteUser(user, username) {\n  return instance.delete(`/api/users/${username}`, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction getOrders(user, text) {\n  const url = text ? `/api/orders?text=${text}` : '/api/orders'\n  return instance.get(url, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction deleteOrder(user, orderId) {\n  return instance.delete(`/api/orders/${orderId}`, {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\nfunction createOrder(user, order) {\n  return instance.post('/api/orders', order, {\n    headers: {\n      'Content-type': 'application/json',\n      'Authorization': bearerAuth(user)\n    }\n  })\n}\n\nfunction getUserMe(user) {\n  return instance.get('/api/users/me', {\n    headers: { 'Authorization': bearerAuth(user) }\n  })\n}\n\n// -- Axios\n\nconst instance = axios.create({\n  baseURL: config.url.API_BASE_URL\n})\n\ninstance.interceptors.request.use(function (config) {\n  // If token is expired, redirect user to login\n  if (config.headers.Authorization) {\n    const token = config.headers.Authorization.split(' ')[1]\n    const data = parseJwt(token)\n    if (Date.now() > data.exp * 1000) {\n      window.location.href = \"/login\"\n    }\n  }\n  return config\n}, function (error) {\n  return Promise.reject(error)\n})\n\n// -- Helper functions\n\nfunction bearerAuth(user) {\n  return `Bearer ${user.accessToken}`\n}"]},"metadata":{},"sourceType":"module"}